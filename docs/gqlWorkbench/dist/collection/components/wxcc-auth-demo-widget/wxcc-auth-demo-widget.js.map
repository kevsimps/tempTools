{"version":3,"file":"wxcc-auth-demo-widget.js","sourceRoot":"","sources":["../../../src/components/wxcc-auth-demo-widget/wxcc-auth-demo-widget.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, h, Method, State, Listen, Prop } from \"@stencil/core\";\r\n\r\n@Component({\r\n    tag: \"wxcc-auth-demo-widget\",\r\n    styleUrl: \"wxcc-auth-demo-widget.css\",\r\n    shadow: true\r\n})\r\n\r\nexport class wxccAuth {\r\n\r\n    @State() token\r\n    @State() expStamp\r\n    @State() hide = true\r\n    @Prop() callbackUrl: string\r\n    @State() deets\r\n    @State() request\r\n    @State() showResponse = false\r\n\r\n    @Method()\r\n    async burp(x) {\r\n        console.log(x)\r\n        const code = x.slice(x.search(\"=\") + 1, x.search(\"&\"))\r\n        // console.log(code)\r\n        let myHeaders = new Headers();\r\n        myHeaders.append(\"Content-Type\", \"application/json\");\r\n        // let urlencoded = new URLSearchParams();\r\n        // urlencoded.append(\"grant_type\", \"authorization_code\")\r\n        // urlencoded.append(\"redirect_uri\", this.callbackUrl)\r\n        // urlencoded.append(\"client_id\", \"C1b249680a1788a109f1cd53c578c874a28a3e6468929598d4552d17d0a12f32f\")\r\n        // urlencoded.append(\"client_secret\", \"49aad1cd3ed0758755c69d818baf897923876854423dbc01d608fc8255d14044\")\r\n        // urlencoded.append(\"code\", code)\r\n        let urlencoded = { \"grant_type\": \"authorization_code\", \"redirect_uri\": this.callbackUrl, \"client_id\": \"C1b249680a1788a109f1cd53c578c874a28a3e6468929598d4552d17d0a12f32f\", \"client_secret\": \"49aad1cd3ed0758755c69d818baf897923876854423dbc01d608fc8255d14044\", \"code\": code }\r\n        let requestOptions = {\r\n            method: 'POST',\r\n            headers: myHeaders,\r\n            body: JSON.stringify(urlencoded)\r\n        };\r\n        // console.log(urlencoded.toString())\r\n        this.request = urlencoded //.toString() //.replace(/[\"&\"]/g,\"\\r\\n\")\r\n        let response = await fetch(\"https://webexapis.com/v1/access_token\", requestOptions)\r\n        this.deets = await response.json()\r\n        // console.log(await this.deets)\r\n        this.token = \"Bearer \" + this.deets.access_token\r\n        this.expStamp = new Date(Date.now() + (this.deets.expires_in * 1000))\r\n        // sessionStorage.setItem(\"token\", this.token)\r\n        // sessionStorage.setItem(\"expStamp\", this.expStamp)\r\n        // console.log(this.token)\r\n        // console.log(this.expStamp)\r\n\r\n        this.hide = false\r\n        this.showResponse = false\r\n\r\n\r\n    }\r\n    @Listen('wxccAuthPop', { target: \"body\" })\r\n    onGetAuth() {\r\n        if (+new Date(sessionStorage.getItem(\"expStamp\")) > Date.now()) {\r\n            this.token = sessionStorage.getItem(\"token\")\r\n            this.hide = false\r\n            this.showResponse = false\r\n        }\r\n        else {\r\n            window.open(`https://webexapis.com/v1/authorize?response_type=code&client_id=C1b249680a1788a109f1cd53c578c874a28a3e6468929598d4552d17d0a12f32f&state=new&scope=cjp%3Aconfig%20cjp%3Aconfig_read%20cjp%3Aconfig_write&redirect_uri=${this.callbackUrl}`, \"steve\", \"popup\")\r\n        }\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n        let tok\r\n        if(this.request){\r\n        tok = <p><h1>The code is sent with this information from the app </h1>\r\n                grant_type: {this.request.grant_type}<br></br>\r\n                redirect_uri: {this.request.redirect_uri}<br></br>\r\n                client_id: {this.request.client_id}<br></br>\r\n                client_secret: {this.request.client_secret}<br></br>\r\n                <strong>code:{this.request.code}</strong><br></br>\r\n            </p>\r\n        if (this.showResponse) {\r\n            tok = <p><h1>This is the response with the token information </h1>\r\n                    access_token: {this.deets.access_token}<br></br>\r\n                    expires_in: {this.deets.expires_in}<br></br>\r\n                    refresh_token: {this.deets.refresh_token}<br></br>\r\n                    refresh_token_expires_in: {this.deets.refresh_token_expires_in}<br></br>\r\n                    token_type: {this.deets.token_type}<br></br>\r\n                    scope: {this.deets.scope}\r\n\r\n                </p>\r\n        }\r\n\r\n    }\r\n        // deets: ${JSON.stringify(this.deets)}\r\n\r\n        // {\r\n        //     \"headers\":{\r\n        //     \"Authorization\":\"${this.token}\"\r\n        //     }\r\n        // }`\r\n\r\n        return [\r\n            <div class={\"frame\" + (this.hide ? \" hidden\" : \"\")}>\r\n                {/* <h1>Copy this text into your Global Environment Variable</h1> */}\r\n                <p>\r\n                    {tok}\r\n                </p>\r\n                <button onClick={() => {this.showResponse = !this.showResponse}}>{this.showResponse ? \"Show Request\" : \"Show Response\"}</button><button onClick={() => { this.hide = !this.hide }}>close</button>\r\n                {/* <button onClick={this.onGetAuth.bind(this)}>{this.expStamp>Date.now() ? `Auth good until ${this.expStamp}`:\"Launch Auth\"}</button> */}\r\n            </div>\r\n        ]\r\n    }\r\n}"]}